import{g as i}from"./githubAuth-CGv4lv3t.js";import{_ as m,c as u,o as d,e as a,d as t,t as h,F as g,f as p}from"./app-DeRILaru.js";import"./request-CLbAAu_4.js";const k={name:"GitHubLogin",data(){return{currentUser:null,mockUsername:"",isDevelopment:!1}},computed:{isLoggedIn(){return!!this.currentUser}},mounted(){this.handleOAuthCallback(),this.loadUserInfo(),window.addEventListener("storage",this.handleStorageChange)},beforeUnmount(){window.removeEventListener("storage",this.handleStorageChange)},methods:{async handleOAuthCallback(){const e=new URLSearchParams(window.location.search),o=e.get("code"),c=e.get("state");if(o&&c)try{const n=await i.handleCallback(o,c);this.currentUser=n,this.$emit("login",n);const r=window.location.pathname+window.location.hash;window.history.replaceState({},document.title,r)}catch(n){console.error("OAuthå›è°ƒå¤„ç†å¤±è´¥:",n),this.$emit("error","GitHubç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•");const r=window.location.pathname+window.location.hash;window.history.replaceState({},document.title,r)}},loadUserInfo(){this.currentUser=i.getCurrentUser()},login(){try{i.login()}catch(e){console.error("ç™»å½•å¤±è´¥:",e),this.$emit("error","ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•")}},logout(){try{i.logout(),this.currentUser=null,this.$emit("logout")}catch(e){console.error("ç™»å‡ºå¤±è´¥:",e)}},mockLogin(){if(!this.mockUsername.trim()){alert("è¯·è¾“å…¥GitHubç”¨æˆ·å");return}try{const e=i.mockLogin(this.mockUsername.trim());this.currentUser=e,this.mockUsername="",this.$emit("login",e)}catch(e){console.error("æ¨¡æ‹Ÿç™»å½•å¤±è´¥:",e),this.$emit("error","æ¨¡æ‹Ÿç™»å½•å¤±è´¥")}},handleStorageChange(e){e.key==="github_user"&&this.loadUserInfo()}}},v={class:"github-login"},w={key:0,class:"user-info"},U=["src","alt"],_={class:"user-details"},b={class:"user-name"},f={class:"user-login"},y={class:"user-actions"},C={class:"login-prompt"};function L(e,o,c,n,r,s){return d(),u("div",v,[a(" å·²ç™»å½•çŠ¶æ€ "),s.isLoggedIn?(d(),u("div",w,[t("img",{src:r.currentUser.avatar_url,alt:r.currentUser.login,class:"user-avatar"},null,8,U),t("div",_,[t("span",b,h(r.currentUser.name||r.currentUser.login),1),t("span",f,"@"+h(r.currentUser.login),1)]),t("div",y,[t("button",{onClick:o[0]||(o[0]=(...l)=>s.logout&&s.logout(...l)),class:"logout-btn",title:"ç™»å‡º"}," ğŸšª ")])])):(d(),u(g,{key:1},[a(" æœªç™»å½•çŠ¶æ€ "),t("div",C,[t("button",{onClick:o[1]||(o[1]=(...l)=>s.login&&s.login(...l)),class:"login-btn"},[...o[2]||(o[2]=[t("svg",{class:"github-icon",viewBox:"0 0 16 16",width:"16",height:"16"},[t("path",{fill:"currentColor",d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"})],-1),p(" ä½¿ç”¨ GitHub ç™»å½• ",-1)])]),a(" å¼€å‘æ¨¡å¼ä¸‹çš„æ¨¡æ‹Ÿç™»å½• "),a(` <div v-if="isDevelopment" class="dev-login">
        <hr class="divider" />
        <p class="dev-note">å¼€å‘æ¨¡å¼ - æ¨¡æ‹Ÿç™»å½•</p>
        <div class="mock-login-form">
          <input 
            v-model="mockUsername" 
            placeholder="è¾“å…¥GitHubç”¨æˆ·å" 
            class="mock-input"
            @keyup.enter="mockLogin"
          />
          <button @click="mockLogin" class="mock-login-btn">æ¨¡æ‹Ÿç™»å½•</button>
        </div>
      </div> `)])],2112))])}const I=m(k,[["render",L],["__scopeId","data-v-656d6d13"]]);export{I as default};

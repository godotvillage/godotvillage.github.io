import{j as c,y as D,c as i,o as u,a as t,f as b,q as r,v as m,t as d,B as y,d as h,C as _,x as w,F as I,h as V,b as C}from"./app-DzizzRvO.js";import{p as k}from"./request-Bnfiq4FI.js";import{_ as E}from"./plugin-vue_export-helper-DlAUqK2U.js";const N={class:"project-submit-form"},O={class:"form-group"},F={class:"char-count"},P={class:"form-group"},U={class:"char-count"},q={class:"form-group"},A={class:"char-count"},B={class:"form-row"},K={class:"form-group"},M={class:"form-group"},J={class:"form-group"},L=["onKeydown"],$={key:0,class:"tags-container"},z=["onClick"],G={class:"form-actions"},H=["disabled"],Q={key:0,class:"success-message"},R={__name:"ProjectSubmitForm",setup(W){const o=c({submitter:"",name:"",description:"",category:"",expectedTime:"",tags:[]}),l=c(""),p=c(!1),n=c(!1),g=D(()=>o.value.submitter.trim()&&o.value.name.trim()&&o.value.description.trim()),T=()=>{const s=l.value.trim();s&&!o.value.tags.includes(s)&&o.value.tags.length<10&&(o.value.tags.push(s),l.value="")},S=s=>{o.value.tags.splice(s,1)},v=()=>{o.value={submitter:"",name:"",description:"",category:"",expectedTime:"",tags:[]},l.value="",p.value=!1},x=async()=>{if(!(!g.value||n.value)){n.value=!0;try{const s={title:o.value.name,description:o.value.description,author:o.value.submitter,category:o.value.category,priority:"中等",status:"计划中",progress:0,tags:o.value.tags,expected_end_date:o.value.expectedTime?j(o.value.expectedTime):null},e=await k.createProject(s);if(e.success)window.dispatchEvent(new CustomEvent("projectAdded",{detail:e.data})),p.value=!0,setTimeout(()=>{v()},2e3);else throw new Error(e.error||"创建项目失败")}catch(s){console.error("提交项目失败:",s),alert("提交失败，请稍后重试："+s.message);const e={id:Date.now().toString(),...o.value,status:"进行中",createdAt:new Date().toISOString(),author:o.value.submitter},a=JSON.parse(localStorage.getItem("farmProjects")||"[]");a.unshift(e),localStorage.setItem("farmProjects",JSON.stringify(a)),window.dispatchEvent(new CustomEvent("projectAdded",{detail:e})),p.value=!0,setTimeout(()=>{v()},2e3)}finally{n.value=!1}}},j=s=>{const e=new Date;switch(s){case"1周内":return new Date(e.getTime()+10080*60*1e3).toISOString().split("T")[0];case"1个月内":return new Date(e.getTime()+720*60*60*1e3).toISOString().split("T")[0];case"3个月内":return new Date(e.getTime()+2160*60*60*1e3).toISOString().split("T")[0];case"半年内":return new Date(e.getTime()+4320*60*60*1e3).toISOString().split("T")[0];case"长期项目":return new Date(e.getTime()+365*24*60*60*1e3).toISOString().split("T")[0];default:return null}};return(s,e)=>(u(),i("div",N,[e[15]||(e[15]=t("div",{class:"form-header"},[t("h3",null,"🌱 种下你的创意种子"),t("p",null,"分享你的项目想法，让社区一起来帮助实现！")],-1)),t("form",{onSubmit:w(x,["prevent"]),class:"submit-form"},[t("div",O,[e[6]||(e[6]=t("label",{for:"submitter"},"填写人 *",-1)),r(t("input",{id:"submitter","onUpdate:modelValue":e[0]||(e[0]=a=>o.value.submitter=a),type:"text",placeholder:"请输入您的姓名或ID",required:"",maxlength:"30"},null,512),[[m,o.value.submitter]]),t("span",F,d(o.value.submitter.length)+"/30",1)]),t("div",P,[e[7]||(e[7]=t("label",{for:"projectName"},"项目名称 *",-1)),r(t("input",{id:"projectName","onUpdate:modelValue":e[1]||(e[1]=a=>o.value.name=a),type:"text",placeholder:"给你的项目起个响亮的名字",required:"",maxlength:"50"},null,512),[[m,o.value.name]]),t("span",U,d(o.value.name.length)+"/50",1)]),t("div",q,[e[8]||(e[8]=t("label",{for:"projectDescription"},"详细灵感描述 *",-1)),r(t("textarea",{id:"projectDescription","onUpdate:modelValue":e[2]||(e[2]=a=>o.value.description=a),placeholder:"详细描述你的项目想法、目标、技术栈等...",required:"",rows:"6",maxlength:"1000"},null,512),[[m,o.value.description]]),t("span",A,d(o.value.description.length)+"/1000",1)]),t("div",B,[t("div",K,[e[10]||(e[10]=t("label",{for:"projectCategory"},"项目分类",-1)),r(t("select",{id:"projectCategory","onUpdate:modelValue":e[3]||(e[3]=a=>o.value.category=a)},[...e[9]||(e[9]=[t("option",{value:""},"选择分类",-1),t("option",{value:"2D"},"🎨 2D",-1),t("option",{value:"3D"},"🎯 3D",-1)])],512),[[y,o.value.category]])]),t("div",M,[e[12]||(e[12]=t("label",{for:"expectedTime"},"预期完成时间",-1)),r(t("select",{id:"expectedTime","onUpdate:modelValue":e[4]||(e[4]=a=>o.value.expectedTime=a)},[...e[11]||(e[11]=[h('<option value="" data-v-400f19aa>选择时间</option><option value="1周内" data-v-400f19aa>⚡ 1周内</option><option value="1个月内" data-v-400f19aa>🚀 1个月内</option><option value="3个月内" data-v-400f19aa>📅 3个月内</option><option value="半年内" data-v-400f19aa>⏰ 半年内</option><option value="长期项目" data-v-400f19aa>🎯 长期项目</option>',6)])],512),[[y,o.value.expectedTime]])])]),t("div",J,[e[13]||(e[13]=t("label",{for:"customTags"},"自定义标签",-1)),r(t("input",{id:"customTags","onUpdate:modelValue":e[5]||(e[5]=a=>l.value=a),type:"text",placeholder:"输入标签后按回车添加，如：肉鸽，模拟经营，回合制",onKeydown:_(w(T,["prevent"]),["enter"])},null,40,L),[[m,l.value]]),o.value.tags.length>0?(u(),i("div",$,[(u(!0),i(I,null,V(o.value.tags,(a,f)=>(u(),i("span",{key:f,class:"tag"},[C(d(a)+" ",1),t("button",{type:"button",onClick:X=>S(f),class:"tag-remove"},"×",8,z)]))),128))])):b("v-if",!0)]),t("div",G,[t("button",{type:"button",onClick:v,class:"btn-secondary"}," 🔄 重置表单 "),t("button",{type:"submit",class:"btn-primary",disabled:!g.value||n.value},d(n.value?"🌱 正在种植...":"🌱 种下种子"),9,H)])],32),p.value?(u(),i("div",Q,[...e[14]||(e[14]=[t("h4",null,"🎉 项目提交成功！",-1),t("p",null,"你的创意种子已经种下，期待它茁壮成长！",-1)])])):b("v-if",!0)]))}},te=E(R,[["__scopeId","data-v-400f19aa"]]);export{te as default};

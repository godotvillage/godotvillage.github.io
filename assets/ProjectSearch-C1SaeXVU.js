import{_ as V,m,p as q,q as B,c as o,o as n,d as a,e as u,i as Q,v as R,F as h,g as y,f as g,t as l,h as p,k as T}from"./app-CjlwLEwM.js";import{projectApi as z}from"./request-Bu-qXTf0.js";const E={class:"project-search"},J={class:"search-container"},O={class:"search-input-group"},W={class:"search-filters"},U={class:"quick-filters"},G=["onClick"],K={key:0,class:"search-results"},X={class:"results-header"},Y={class:"results-count"},Z={key:0,class:"no-results"},j={key:1,class:"results-grid"},ss=["onClick"],es={class:"result-header"},ts=["innerHTML"],as={class:"result-meta"},ls={key:0,class:"result-category"},os={class:"result-date"},ns=["innerHTML"],is={key:0,class:"result-tags"},rs=["innerHTML"],cs={key:0,class:"more-tags"},us={class:"result-footer"},ds={class:"result-author"},vs={class:"result-actions"},gs=["onClick"],_s={class:"modal-header"},ms={class:"modal-body"},hs={class:"project-detail-meta"},ys={class:"detail-item"},ks={key:0,class:"detail-item"},fs={key:1,class:"detail-item"},ps={class:"detail-item"},Cs={class:"detail-item"},bs={class:"detail-description"},ws={key:0,class:"detail-tags"},Ls={class:"tags-list"},Ss={__name:"ProjectSearch",setup(Fs){const r=m(""),d=m(""),i=m(null),_=m([]),D=[{key:"recent",label:"æœ€è¿‘åˆ›å»º",icon:"ðŸ†•"},{key:"inProgress",label:"è¿›è¡Œä¸­",icon:"ðŸš€"},{key:"completed",label:"å·²å®Œæˆ",icon:"âœ…"}],k=q(()=>{let t=_.value;if(d.value)switch(d.value){case"recent":const s=new Date;s.setDate(s.getDate()-7),t=t.filter(e=>new Date(e.created_time)>s);break;case"inProgress":t=t.filter(e=>e.status==="è¿›è¡Œä¸­");break;case"completed":t=t.filter(e=>e.status==="å·²å®Œæˆ");break;case"gamedev":t=t.filter(e=>e.category==="æ¸¸æˆå¼€å‘"||e.category==="2D"||e.category==="3D");break;case"webapp":t=t.filter(e=>e.category==="ç½‘ç«™åº”ç”¨");break}if(r.value.trim()){const s=r.value.toLowerCase().trim();t=t.filter(e=>(e.title||"").toLowerCase().includes(s)||e.description&&e.description.toLowerCase().includes(s)||e.tags&&e.tags.some(v=>v.toLowerCase().includes(s))||e.category&&e.category.toLowerCase().includes(s)||e.author&&e.author.toLowerCase().includes(s))}if(r.value.trim()){const s=r.value.toLowerCase().trim();t.sort((e,c)=>{const v=b(e,s);return b(c,s)-v})}return t}),M=async()=>{try{const t=await z.getProjects();t.success&&(_.value=t.data.map(s=>({...s,name:s.title,createdAt:s.created_time})))}catch(t){console.error("èŽ·å–é¡¹ç›®åˆ—è¡¨å¤±è´¥:",t);const s=localStorage.getItem("farmProjects");s&&(_.value=JSON.parse(s))}},P=()=>{r.value.trim()&&(d.value="")},N=()=>{r.value=""},x=t=>{d.value===t.key?d.value="":(d.value=t.key,r.value="")},H=()=>{r.value="",d.value=""},I=t=>{i.value=t},C=()=>{i.value=null},$=async t=>{t.isFavorite=!t.isFavorite;try{localStorage.setItem("farmProjects",JSON.stringify(_.value))}catch(s){console.error("æ›´æ–°æ”¶è—çŠ¶æ€å¤±è´¥:",s),t.isFavorite=!t.isFavorite}},b=(t,s)=>{let e=0;const c=t.title||"";return c.toLowerCase().includes(s)&&(e+=10,c.toLowerCase().startsWith(s)&&(e+=5)),t.description&&t.description.toLowerCase().includes(s)&&(e+=5),t.tags&&t.tags.some(v=>v.toLowerCase().includes(s))&&(e+=3),t.category&&t.category.toLowerCase().includes(s)&&(e+=2),e},f=t=>{if(!r.value.trim())return t;const s=r.value.trim(),e=new RegExp(`(${s})`,"gi");return t.replace(e,"<mark>$1</mark>")},w=t=>({è¿›è¡Œä¸­:"status-progress",å·²å®Œæˆ:"status-completed",æš‚åœ:"status-paused",è®¡åˆ’ä¸­:"status-planned"})[t]||"status-default",L=t=>({è¿›è¡Œä¸­:"ðŸš€",å·²å®Œæˆ:"âœ…",æš‚åœ:"â¸ï¸",è®¡åˆ’ä¸­:"ðŸ“‹"})[t]||"ðŸ“",S=t=>({æ¸¸æˆå¼€å‘:"ðŸŽ®",ç½‘ç«™åº”ç”¨:"ðŸŒ",ç§»åŠ¨åº”ç”¨:"ðŸ“±",å·¥å…·è½¯ä»¶:"ðŸ”§",å­¦ä¹ é¡¹ç›®:"ðŸ“š",å¼€æºè´¡çŒ®:"ðŸ¤",å…¶ä»–:"ðŸŽ¯"})[t]||"ðŸ“",A=(t,s)=>t.length<=s?t:t.substring(0,s)+"...",F=t=>new Date(t).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"});return B(()=>{M()}),(t,s)=>(n(),o("div",E,[s[12]||(s[12]=a("div",{class:"search-header"},[a("h3",null,"ðŸ” é¡¹ç›®æœç´¢"),a("p",null,"å¿«é€Ÿæ‰¾åˆ°ä½ æ„Ÿå…´è¶£çš„é¡¹ç›®")],-1)),a("div",J,[a("div",O,[Q(a("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>r.value=e),type:"text",placeholder:"æœç´¢é¡¹ç›®åç§°ã€æè¿°æˆ–æ ‡ç­¾...",class:"search-input",onInput:P},null,544),[[R,r.value]]),r.value?(n(),o("button",{key:0,onClick:N,class:"clear-btn"}," âœ• ")):u("v-if",!0)]),a("div",W,[a("div",U,[s[2]||(s[2]=a("span",{class:"filter-label"},"å¿«é€Ÿç­›é€‰ï¼š",-1)),(n(),o(h,null,y(D,e=>a("button",{key:e.key,onClick:c=>x(e),class:p(["quick-filter-btn",{active:d.value===e.key}])},l(e.icon)+" "+l(e.label),11,G)),64))])])]),r.value||d.value?(n(),o("div",K,[a("div",X,[a("h4",null,[s[3]||(s[3]=g(" æœç´¢ç»“æžœ ",-1)),a("span",Y,"("+l(k.value.length)+" ä¸ªé¡¹ç›®)",1)]),a("button",{onClick:H,class:"clear-all-btn"}," æ¸…é™¤æ‰€æœ‰ç­›é€‰ ")]),k.value.length===0?(n(),o("div",Z,[...s[4]||(s[4]=[a("div",{class:"no-results-icon"},"ðŸ”",-1),a("h4",null,"æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„é¡¹ç›®",-1),a("p",null,"å°è¯•è°ƒæ•´æœç´¢å…³é”®è¯æˆ–ç­›é€‰æ¡ä»¶",-1)])])):(n(),o("div",j,[(n(!0),o(h,null,y(k.value,e=>(n(),o("div",{key:e.id,class:"result-card",onClick:c=>I(e)},[a("div",es,[a("h5",{class:"result-title",innerHTML:f(e.title)},null,8,ts),a("span",{class:p(["result-status",w(e.status)])},l(L(e.status))+" "+l(e.status),3)]),a("div",as,[e.category?(n(),o("span",ls,l(S(e.category))+" "+l(e.category),1)):u("v-if",!0),a("span",os,l(F(e.created_time)),1)]),a("p",{class:"result-description",innerHTML:f(A(e.description||"",100))},null,8,ns),e.tags&&e.tags.length>0?(n(),o("div",is,[(n(!0),o(h,null,y(e.tags.slice(0,3),c=>(n(),o("span",{key:c,class:"result-tag",innerHTML:f(c)},null,8,rs))),128)),e.tags.length>3?(n(),o("span",cs," +"+l(e.tags.length-3),1)):u("v-if",!0)])):u("v-if",!0),a("div",us,[a("span",ds,"ðŸ‘¤ "+l(e.author),1),a("div",vs,[a("button",{onClick:T(c=>$(e),["stop"]),class:"action-btn"},l(e.isFavorite?"â¤ï¸":"ðŸ¤"),9,gs)])])],8,ss))),128))]))])):u("v-if",!0),u(" é¡¹ç›®è¯¦æƒ…æ¨¡æ€æ¡† "),i.value?(n(),o("div",{key:1,class:"modal-overlay",onClick:C},[a("div",{class:"modal-content",onClick:s[1]||(s[1]=T(()=>{},["stop"]))},[a("div",_s,[a("h3",null,l(i.value.title),1),a("button",{onClick:C,class:"close-btn"},"Ã—")]),a("div",ms,[a("div",hs,[a("div",ys,[s[5]||(s[5]=a("strong",null,"çŠ¶æ€ï¼š",-1)),a("span",{class:p(["project-status",w(i.value.status)])},l(L(i.value.status))+" "+l(i.value.status),3)]),i.value.category?(n(),o("div",ks,[s[6]||(s[6]=a("strong",null,"åˆ†ç±»ï¼š",-1)),g(" "+l(S(i.value.category))+" "+l(i.value.category),1)])):u("v-if",!0),i.value.expectedTime?(n(),o("div",fs,[s[7]||(s[7]=a("strong",null,"é¢„æœŸå®Œæˆæ—¶é—´ï¼š",-1)),g(" â° "+l(i.value.expectedTime),1)])):u("v-if",!0),a("div",ps,[s[8]||(s[8]=a("strong",null,"åˆ›å»ºè€…ï¼š",-1)),g(" ðŸ‘¤ "+l(i.value.author),1)]),a("div",Cs,[s[9]||(s[9]=a("strong",null,"åˆ›å»ºæ—¶é—´ï¼š",-1)),g(" "+l(F(i.value.created_time)),1)])]),a("div",bs,[s[10]||(s[10]=a("strong",null,"é¡¹ç›®æè¿°ï¼š",-1)),a("p",null,l(i.value.description),1)]),i.value.tags&&i.value.tags.length>0?(n(),o("div",ws,[s[11]||(s[11]=a("strong",null,"æ ‡ç­¾ï¼š",-1)),a("div",Ls,[(n(!0),o(h,null,y(i.value.tags,e=>(n(),o("span",{key:e,class:"detail-tag"},l(e),1))),128))])])):u("v-if",!0)])])])):u("v-if",!0)]))}},Ps=V(Ss,[["__scopeId","data-v-a9a5b8ee"]]);export{Ps as default};

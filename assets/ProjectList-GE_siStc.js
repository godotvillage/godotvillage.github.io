import{_ as O,l as c,m as y,p as z,q as J,c as l,o as i,d as s,e as d,t as a,i as f,s as h,a as $,F as k,g as w,h as N,f as m,k as L}from"./app-DDR52eiE.js";import{projectApi as V}from"./request-Bu-qXTf0.js";const q={class:"project-list"},K={class:"list-header"},G={class:"stats"},H={class:"stat-item"},Q={class:"stat-number"},R={class:"stat-item"},W={class:"stat-number"},X={class:"stat-item"},Y={class:"stat-number"},Z={class:"filter-controls"},tt={class:"filter-group"},st={class:"filter-group"},et={class:"filter-group"},ot={key:0,class:"empty-state"},at={key:1,class:"projects-grid"},nt=["onClick"],lt={class:"project-content"},it={class:"project-header"},dt={class:"project-title"},rt={class:"project-meta"},ut={key:0,class:"project-category"},ct={key:1,class:"project-time"},vt={class:"project-description"},pt={key:0,class:"project-tags"},mt={key:0,class:"more-tags"},gt={class:"project-footer"},_t={class:"project-author"},yt={class:"project-date"},ft={class:"project-actions"},ht=["onClick"],kt={class:"modal-header"},wt={class:"modal-body"},bt={class:"project-detail-meta"},Ct={class:"detail-item"},Dt={key:0,class:"detail-item"},xt={key:1,class:"detail-item"},Pt={class:"detail-item"},St={class:"detail-item"},jt={class:"detail-description"},It={key:0,class:"detail-tags"},Nt={class:"tags-list"},Lt={__name:"ProjectList",setup(Vt){const r=c([]),n=c(null),v=c(""),p=c(""),g=c("newest"),E=y(()=>r.value.filter(e=>e.status==="è¿›è¡Œä¸­").length),T=y(()=>r.value.filter(e=>e.status==="å·²å®Œæˆ").length),b=y(()=>{let e=r.value;return v.value&&(e=e.filter(t=>t.status===v.value)),p.value&&(e=e.filter(t=>t.category===p.value)),e.sort((t,o)=>{switch(g.value){case"oldest":return new Date(t.create_time)-new Date(o.create_time);case"name":return t.title.localeCompare(o.title);case"newest":default:return new Date(o.create_time)-new Date(t.create_time)}}),e}),C=async()=>{try{const e=await V.getProjects();e.success&&(r.value=e.data.map(t=>({...t,name:t.title,createdAt:t.create_time})))}catch(e){console.error("è·å–é¡¹ç›®åˆ—è¡¨å¤±è´¥:",e);const t=localStorage.getItem("farmProjects");t&&(r.value=JSON.parse(t))}},A=async e=>{try{await V.updateProject(e.project_id,{status:e.status})}catch(t){console.error("æ›´æ–°é¡¹ç›®å¤±è´¥:",t),localStorage.setItem("farmProjects",JSON.stringify(r.value))}},B=e=>{n.value=e,document.body.style.overflow="hidden"},_=()=>{n.value=null,document.body.style.overflow=""},F=async e=>{const t=["è®¡åˆ’ä¸­","è¿›è¡Œä¸­","æš‚åœ","å·²å®Œæˆ"],u=(t.indexOf(e.status)+1)%t.length;e.status=t[u],await A(e)},D=e=>({è¿›è¡Œä¸­:"status-progress",å·²å®Œæˆ:"status-completed",æš‚åœ:"status-paused",è®¡åˆ’ä¸­:"status-planned"})[e]||"status-default",x=e=>({è¿›è¡Œä¸­:"ğŸš€",å·²å®Œæˆ:"âœ…",æš‚åœ:"â¸ï¸",è®¡åˆ’ä¸­:"ğŸ“‹"})[e]||"ğŸ“",M=e=>({è®¡åˆ’ä¸­:"ğŸš€",è¿›è¡Œä¸­:"â¸ï¸",æš‚åœ:"âœ…",å·²å®Œæˆ:"ğŸ“‹"})[e]||"ğŸ”„",P=e=>({"2D":"ğŸ¨","3D":"ğŸ¯"})[e]||"ğŸ“",U=(e,t)=>e.length<=t?e:e.substring(0,t)+"...",S=e=>new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"}),j=e=>{C()},I=e=>{e.key==="Escape"&&n.value&&_()};return z(()=>{C(),window.addEventListener("projectAdded",j),document.addEventListener("keydown",I)}),J(()=>{window.removeEventListener("projectAdded",j),document.removeEventListener("keydown",I),document.body.style.overflow=""}),(e,t)=>(i(),l("div",q,[s("div",K,[t[7]||(t[7]=s("h3",null,"ğŸŒ¾ å†œåœºé¡¹ç›®å±•ç¤º",-1)),s("div",G,[s("span",H,[s("span",Q,a(r.value.length),1),t[4]||(t[4]=s("span",{class:"stat-label"},"æ€»é¡¹ç›®æ•°",-1))]),s("span",R,[s("span",W,a(E.value),1),t[5]||(t[5]=s("span",{class:"stat-label"},"è¿›è¡Œä¸­",-1))]),s("span",X,[s("span",Y,a(T.value),1),t[6]||(t[6]=s("span",{class:"stat-label"},"å·²å®Œæˆ",-1))])])]),s("div",Z,[s("div",tt,[t[9]||(t[9]=s("label",null,"çŠ¶æ€ç­›é€‰ï¼š",-1)),f(s("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>v.value=o)},[...t[8]||(t[8]=[$('<option value="" data-v-0ed869a1>å…¨éƒ¨çŠ¶æ€</option><option value="è¿›è¡Œä¸­" data-v-0ed869a1>ğŸš€ è¿›è¡Œä¸­</option><option value="å·²å®Œæˆ" data-v-0ed869a1>âœ… å·²å®Œæˆ</option><option value="æš‚åœ" data-v-0ed869a1>â¸ï¸ æš‚åœ</option><option value="è®¡åˆ’ä¸­" data-v-0ed869a1>ğŸ“‹ è®¡åˆ’ä¸­</option>',5)])],512),[[h,v.value]])]),s("div",st,[t[11]||(t[11]=s("label",null,"åˆ†ç±»ç­›é€‰ï¼š",-1)),f(s("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>p.value=o)},[...t[10]||(t[10]=[s("option",{value:""},"å…¨éƒ¨åˆ†ç±»",-1),s("option",{value:"2D"},"ğŸ¨ 2D",-1),s("option",{value:"3D"},"ğŸ¯ 3D",-1)])],512),[[h,p.value]])]),s("div",et,[t[13]||(t[13]=s("label",null,"æ’åºæ–¹å¼ï¼š",-1)),f(s("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>g.value=o)},[...t[12]||(t[12]=[s("option",{value:"newest"},"æœ€æ–°åˆ›å»º",-1),s("option",{value:"oldest"},"æœ€æ—©åˆ›å»º",-1),s("option",{value:"name"},"é¡¹ç›®åç§°",-1)])],512),[[h,g.value]])])]),b.value.length===0?(i(),l("div",ot,[...t[14]||(t[14]=[s("div",{class:"empty-icon"},"ğŸŒ±",-1),s("h4",null,"è¿˜æ²¡æœ‰é¡¹ç›®å“¦",-1),s("p",null,"æˆä¸ºç¬¬ä¸€ä¸ªåœ¨å†œåœºç§ä¸‹åˆ›æ„ç§å­çš„äººå§ï¼",-1)])])):(i(),l("div",at,[(i(!0),l(k,null,w(b.value,o=>(i(),l("div",{key:o.id,class:"project-card",onClick:u=>B(o)},[s("div",lt,[s("div",it,[s("h4",dt,a(o.title),1),s("div",{class:N(["project-status",D(o.status)])},a(x(o.status))+" "+a(o.status),3)]),s("div",rt,[o.category?(i(),l("span",ut,a(P(o.category))+" "+a(o.category),1)):d("v-if",!0),o.expectedTime?(i(),l("span",ct," â° "+a(o.expectedTime),1)):d("v-if",!0)]),s("p",vt,a(U(o.description,120)),1),o.tags&&o.tags.length>0?(i(),l("div",pt,[(i(!0),l(k,null,w(o.tags.slice(0,3),u=>(i(),l("span",{key:u,class:"project-tag"},a(u),1))),128)),o.tags.length>3?(i(),l("span",mt," +"+a(o.tags.length-3),1)):d("v-if",!0)])):d("v-if",!0),s("div",gt,[s("span",_t,"ğŸ‘¤ "+a(o.author),1),s("span",yt,a(S(o.create_time)),1)])]),s("div",ft,[s("button",{onClick:L(u=>F(o),["stop"]),class:"action-btn status-btn"},a(M(o.status)),9,ht)])],8,nt))),128))])),d(" é¡¹ç›®è¯¦æƒ…æ¨¡æ€æ¡† "),n.value?(i(),l("div",{key:2,class:"modal-overlay",onClick:_},[s("div",{class:"modal-content",onClick:t[3]||(t[3]=L(()=>{},["stop"]))},[s("div",kt,[s("h3",null,a(n.value.title),1),s("button",{onClick:_,class:"close-btn"},"Ã—")]),s("div",wt,[s("div",bt,[s("div",Ct,[t[15]||(t[15]=s("strong",null,"çŠ¶æ€ï¼š",-1)),s("span",{class:N(["project-status",D(n.value.status)])},a(x(n.value.status))+" "+a(n.value.status),3)]),n.value.category?(i(),l("div",Dt,[t[16]||(t[16]=s("strong",null,"åˆ†ç±»ï¼š",-1)),m(" "+a(P(n.value.category))+" "+a(n.value.category),1)])):d("v-if",!0),n.value.expectedTime?(i(),l("div",xt,[t[17]||(t[17]=s("strong",null,"é¢„æœŸå®Œæˆæ—¶é—´ï¼š",-1)),m(" â° "+a(n.value.expectedTime),1)])):d("v-if",!0),s("div",Pt,[t[18]||(t[18]=s("strong",null,"å¡«å†™äººï¼š",-1)),m(" ğŸ‘¤ "+a(n.value.author),1)]),s("div",St,[t[19]||(t[19]=s("strong",null,"åˆ›å»ºæ—¶é—´ï¼š",-1)),m(" "+a(S(n.value.create_time)),1)])]),s("div",jt,[t[20]||(t[20]=s("strong",null,"é¡¹ç›®æè¿°ï¼š",-1)),s("p",null,a(n.value.description),1)]),n.value.tags&&n.value.tags.length>0?(i(),l("div",It,[t[21]||(t[21]=s("strong",null,"æ ‡ç­¾ï¼š",-1)),s("div",Nt,[(i(!0),l(k,null,w(n.value.tags,o=>(i(),l("span",{key:o,class:"detail-tag"},a(o),1))),128))])])):d("v-if",!0)])])])):d("v-if",!0)]))}},At=O(Lt,[["__scopeId","data-v-0ed869a1"]]);export{At as default};

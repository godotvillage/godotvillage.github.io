import{j as m,y as V,z as q,c as o,o as n,a,f as u,q as z,v as B,F as h,h as y,p,t as l,b as g,x as T}from"./app-Up64sgEO.js";import{p as Q}from"./request-Bnfiq4FI.js";import{_ as R}from"./plugin-vue_export-helper-DlAUqK2U.js";const E={class:"project-search"},J={class:"search-container"},O={class:"search-input-group"},W={class:"search-filters"},U={class:"quick-filters"},G=["onClick"],K={key:0,class:"search-results"},X={class:"results-header"},Y={class:"results-count"},Z={key:0,class:"no-results"},j={key:1,class:"results-grid"},ee=["onClick"],se={class:"result-header"},te=["innerHTML"],ae={class:"result-meta"},le={key:0,class:"result-category"},oe={class:"result-date"},ne=["innerHTML"],ie={key:0,class:"result-tags"},re=["innerHTML"],ce={key:0,class:"more-tags"},ue={class:"result-footer"},de={class:"result-author"},ve={class:"result-actions"},ge=["onClick"],_e={class:"modal-header"},me={class:"modal-body"},he={class:"project-detail-meta"},ye={class:"detail-item"},ke={key:0,class:"detail-item"},fe={key:1,class:"detail-item"},pe={class:"detail-item"},be={class:"detail-item"},Ce={class:"detail-description"},we={key:0,class:"detail-tags"},Le={class:"tags-list"},Se={__name:"ProjectSearch",setup(Fe){const r=m(""),d=m(""),i=m(null),_=m([]),D=[{key:"recent",label:"最近创建",icon:"🆕"},{key:"inProgress",label:"进行中",icon:"🚀"},{key:"completed",label:"已完成",icon:"✅"},{key:"gamedev",label:"游戏开发",icon:"🎮"},{key:"webapp",label:"网站应用",icon:"🌐"}],k=V(()=>{let t=_.value;if(d.value)switch(d.value){case"recent":const e=new Date;e.setDate(e.getDate()-7),t=t.filter(s=>new Date(s.created_time)>e);break;case"inProgress":t=t.filter(s=>s.status==="进行中");break;case"completed":t=t.filter(s=>s.status==="已完成");break;case"gamedev":t=t.filter(s=>s.category==="游戏开发"||s.category==="2D"||s.category==="3D");break;case"webapp":t=t.filter(s=>s.category==="网站应用");break}if(r.value.trim()){const e=r.value.toLowerCase().trim();t=t.filter(s=>(s.title||"").toLowerCase().includes(e)||s.description&&s.description.toLowerCase().includes(e)||s.tags&&s.tags.some(v=>v.toLowerCase().includes(e))||s.category&&s.category.toLowerCase().includes(e)||s.author&&s.author.toLowerCase().includes(e))}if(r.value.trim()){const e=r.value.toLowerCase().trim();t.sort((s,c)=>{const v=C(s,e);return C(c,e)-v})}return t}),M=async()=>{try{const t=await Q.getProjects();t.success&&(_.value=t.data.map(e=>({...e,name:e.title,createdAt:e.created_time})))}catch(t){console.error("获取项目列表失败:",t);const e=localStorage.getItem("farmProjects");e&&(_.value=JSON.parse(e))}},P=()=>{r.value.trim()&&(d.value="")},x=()=>{r.value=""},N=t=>{d.value===t.key?d.value="":(d.value=t.key,r.value="")},H=()=>{r.value="",d.value=""},I=t=>{i.value=t},b=()=>{i.value=null},$=async t=>{t.isFavorite=!t.isFavorite;try{localStorage.setItem("farmProjects",JSON.stringify(_.value))}catch(e){console.error("更新收藏状态失败:",e),t.isFavorite=!t.isFavorite}},C=(t,e)=>{let s=0;const c=t.title||"";return c.toLowerCase().includes(e)&&(s+=10,c.toLowerCase().startsWith(e)&&(s+=5)),t.description&&t.description.toLowerCase().includes(e)&&(s+=5),t.tags&&t.tags.some(v=>v.toLowerCase().includes(e))&&(s+=3),t.category&&t.category.toLowerCase().includes(e)&&(s+=2),s},f=t=>{if(!r.value.trim())return t;const e=r.value.trim(),s=new RegExp(`(${e})`,"gi");return t.replace(s,"<mark>$1</mark>")},w=t=>({进行中:"status-progress",已完成:"status-completed",暂停:"status-paused",计划中:"status-planned"})[t]||"status-default",L=t=>({进行中:"🚀",已完成:"✅",暂停:"⏸️",计划中:"📋"})[t]||"📝",S=t=>({游戏开发:"🎮",网站应用:"🌐",移动应用:"📱",工具软件:"🔧",学习项目:"📚",开源贡献:"🤝",其他:"🎯"})[t]||"📁",A=(t,e)=>t.length<=e?t:t.substring(0,e)+"...",F=t=>new Date(t).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric"});return q(()=>{M()}),(t,e)=>(n(),o("div",E,[e[12]||(e[12]=a("div",{class:"search-header"},[a("h3",null,"🔍 项目搜索"),a("p",null,"快速找到你感兴趣的项目")],-1)),a("div",J,[a("div",O,[z(a("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>r.value=s),type:"text",placeholder:"搜索项目名称、描述或标签...",class:"search-input",onInput:P},null,544),[[B,r.value]]),r.value?(n(),o("button",{key:0,onClick:x,class:"clear-btn"}," ✕ ")):u("v-if",!0)]),a("div",W,[a("div",U,[e[2]||(e[2]=a("span",{class:"filter-label"},"快速筛选：",-1)),(n(),o(h,null,y(D,s=>a("button",{key:s.key,onClick:c=>N(s),class:p(["quick-filter-btn",{active:d.value===s.key}])},l(s.icon)+" "+l(s.label),11,G)),64))])])]),r.value||d.value?(n(),o("div",K,[a("div",X,[a("h4",null,[e[3]||(e[3]=g(" 搜索结果 ",-1)),a("span",Y,"("+l(k.value.length)+" 个项目)",1)]),a("button",{onClick:H,class:"clear-all-btn"}," 清除所有筛选 ")]),k.value.length===0?(n(),o("div",Z,[...e[4]||(e[4]=[a("div",{class:"no-results-icon"},"🔍",-1),a("h4",null,"没有找到匹配的项目",-1),a("p",null,"尝试调整搜索关键词或筛选条件",-1)])])):(n(),o("div",j,[(n(!0),o(h,null,y(k.value,s=>(n(),o("div",{key:s.id,class:"result-card",onClick:c=>I(s)},[a("div",se,[a("h5",{class:"result-title",innerHTML:f(s.title)},null,8,te),a("span",{class:p(["result-status",w(s.status)])},l(L(s.status))+" "+l(s.status),3)]),a("div",ae,[s.category?(n(),o("span",le,l(S(s.category))+" "+l(s.category),1)):u("v-if",!0),a("span",oe,l(F(s.created_time)),1)]),a("p",{class:"result-description",innerHTML:f(A(s.description||"",100))},null,8,ne),s.tags&&s.tags.length>0?(n(),o("div",ie,[(n(!0),o(h,null,y(s.tags.slice(0,3),c=>(n(),o("span",{key:c,class:"result-tag",innerHTML:f(c)},null,8,re))),128)),s.tags.length>3?(n(),o("span",ce," +"+l(s.tags.length-3),1)):u("v-if",!0)])):u("v-if",!0),a("div",ue,[a("span",de,"👤 "+l(s.author),1),a("div",ve,[a("button",{onClick:T(c=>$(s),["stop"]),class:"action-btn"},l(s.isFavorite?"❤️":"🤍"),9,ge)])])],8,ee))),128))]))])):u("v-if",!0),u(" 项目详情模态框 "),i.value?(n(),o("div",{key:1,class:"modal-overlay",onClick:b},[a("div",{class:"modal-content",onClick:e[1]||(e[1]=T(()=>{},["stop"]))},[a("div",_e,[a("h3",null,l(i.value.title),1),a("button",{onClick:b,class:"close-btn"},"×")]),a("div",me,[a("div",he,[a("div",ye,[e[5]||(e[5]=a("strong",null,"状态：",-1)),a("span",{class:p(w(i.value.status))},l(L(i.value.status))+" "+l(i.value.status),3)]),i.value.category?(n(),o("div",ke,[e[6]||(e[6]=a("strong",null,"分类：",-1)),g(" "+l(S(i.value.category))+" "+l(i.value.category),1)])):u("v-if",!0),i.value.expectedTime?(n(),o("div",fe,[e[7]||(e[7]=a("strong",null,"预期完成时间：",-1)),g(" ⏰ "+l(i.value.expectedTime),1)])):u("v-if",!0),a("div",pe,[e[8]||(e[8]=a("strong",null,"创建者：",-1)),g(" 👤 "+l(i.value.author),1)]),a("div",be,[e[9]||(e[9]=a("strong",null,"创建时间：",-1)),g(" "+l(F(i.value.created_time)),1)])]),a("div",Ce,[e[10]||(e[10]=a("strong",null,"项目描述：",-1)),a("p",null,l(i.value.description),1)]),i.value.tags&&i.value.tags.length>0?(n(),o("div",we,[e[11]||(e[11]=a("strong",null,"标签：",-1)),a("div",Le,[(n(!0),o(h,null,y(i.value.tags,s=>(n(),o("span",{key:s,class:"detail-tag"},l(s),1))),128))])])):u("v-if",!0)])])])):u("v-if",!0)]))}},xe=R(Se,[["__scopeId","data-v-9976d2c7"]]);export{xe as default};

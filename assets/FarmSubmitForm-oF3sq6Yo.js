import{_ as D,i as m,j as h,c as i,o as u,d as t,e as b,m as r,q as c,t as d,v as y,a as j,s as I,p as w,F as V,g as F,f as k}from"./app-BZdVsTh-.js";import{f as C}from"./request-7grEb9by.js";const E={class:"project-submit-form"},N={class:"form-group"},O={class:"char-count"},U={class:"form-group"},q={class:"char-count"},P={class:"form-group"},A={class:"char-count"},B={class:"form-row"},K={class:"form-group"},M={class:"form-group"},J={class:"form-group"},L=["onKeydown"],$={key:0,class:"tags-container"},z=["onClick"],G={class:"form-actions"},H=["disabled"],Q={key:0,class:"success-message"},R={__name:"FarmSubmitForm",setup(W){const o=m({submitter:"",name:"",description:"",category:"",expectedTime:"",tags:[]}),l=m(""),p=m(!1),n=m(!1),g=h(()=>o.value.submitter.trim()&&o.value.name.trim()&&o.value.description.trim()),T=()=>{const a=l.value.trim();a&&!o.value.tags.includes(a)&&o.value.tags.length<10&&(o.value.tags.push(a),l.value="")},S=a=>{o.value.tags.splice(a,1)},v=()=>{o.value={submitter:"",name:"",description:"",category:"",expectedTime:"",tags:[]},l.value="",p.value=!1},x=async()=>{if(!(!g.value||n.value)){n.value=!0;try{const a={title:o.value.name,description:o.value.description,author:o.value.submitter,category:o.value.category,priority:"中等",status:"计划中",progress:0,tags:o.value.tags,expected_end_date:o.value.expectedTime?_(o.value.expectedTime):null,github_url:"",demo_url:""},e=await C.createFarmProject(a);if(e.success)window.dispatchEvent(new CustomEvent("projectAdded",{detail:e.data})),p.value=!0,setTimeout(()=>{v()},2e3);else throw new Error(e.error||"创建项目失败")}catch(a){console.error("提交项目失败:",a),alert("提交失败，请稍后重试："+a.message);const e={id:Date.now().toString(),title:o.value.name,...o.value,status:"计划中",create_time:new Date().toISOString(),author:o.value.submitter},s=JSON.parse(localStorage.getItem("farmProjects")||"[]");s.unshift(e),localStorage.setItem("farmProjects",JSON.stringify(s)),window.dispatchEvent(new CustomEvent("projectAdded",{detail:e})),p.value=!0,setTimeout(()=>{v()},2e3)}finally{n.value=!1}}},_=a=>{const e=new Date;switch(a){case"1周内":return new Date(e.getTime()+10080*60*1e3).toISOString().split("T")[0];case"1个月内":return new Date(e.getTime()+720*60*60*1e3).toISOString().split("T")[0];case"3个月内":return new Date(e.getTime()+2160*60*60*1e3).toISOString().split("T")[0];case"半年内":return new Date(e.getTime()+4320*60*60*1e3).toISOString().split("T")[0];case"长期项目":return new Date(e.getTime()+365*24*60*60*1e3).toISOString().split("T")[0];default:return null}};return(a,e)=>(u(),i("div",E,[e[15]||(e[15]=t("div",{class:"form-header"},[t("h3",null,"🌱 种下你的创意种子"),t("p",null,"分享你的项目想法，让社区一起来帮助实现！")],-1)),t("form",{onSubmit:w(x,["prevent"]),class:"submit-form"},[t("div",N,[e[6]||(e[6]=t("label",{for:"submitter"},"填写人 *",-1)),r(t("input",{id:"submitter","onUpdate:modelValue":e[0]||(e[0]=s=>o.value.submitter=s),type:"text",placeholder:"请输入您的姓名或ID",required:"",maxlength:"30"},null,512),[[c,o.value.submitter]]),t("span",O,d(o.value.submitter.length)+"/30",1)]),t("div",U,[e[7]||(e[7]=t("label",{for:"projectName"},"项目名称 *",-1)),r(t("input",{id:"projectName","onUpdate:modelValue":e[1]||(e[1]=s=>o.value.name=s),type:"text",placeholder:"给你的项目起个响亮的名字",required:"",maxlength:"50"},null,512),[[c,o.value.name]]),t("span",q,d(o.value.name.length)+"/50",1)]),t("div",P,[e[8]||(e[8]=t("label",{for:"projectDescription"},"详细灵感描述 *",-1)),r(t("textarea",{id:"projectDescription","onUpdate:modelValue":e[2]||(e[2]=s=>o.value.description=s),placeholder:"详细描述你的项目想法、目标、技术栈等...",required:"",rows:"6",maxlength:"1000"},null,512),[[c,o.value.description]]),t("span",A,d(o.value.description.length)+"/1000",1)]),t("div",B,[t("div",K,[e[10]||(e[10]=t("label",{for:"projectCategory"},"项目分类",-1)),r(t("select",{id:"projectCategory","onUpdate:modelValue":e[3]||(e[3]=s=>o.value.category=s)},[...e[9]||(e[9]=[t("option",{value:""},"选择分类",-1),t("option",{value:"2D"},"🎨 2D",-1),t("option",{value:"3D"},"🎯 3D",-1)])],512),[[y,o.value.category]])]),t("div",M,[e[12]||(e[12]=t("label",{for:"expectedTime"},"预期完成时间",-1)),r(t("select",{id:"expectedTime","onUpdate:modelValue":e[4]||(e[4]=s=>o.value.expectedTime=s)},[...e[11]||(e[11]=[j('<option value="" data-v-350f7c72>选择时间</option><option value="1周内" data-v-350f7c72>⚡ 1周内</option><option value="1个月内" data-v-350f7c72>🚀 1个月内</option><option value="3个月内" data-v-350f7c72>📅 3个月内</option><option value="半年内" data-v-350f7c72>⏰ 半年内</option><option value="长期项目" data-v-350f7c72>🎯 长期项目</option>',6)])],512),[[y,o.value.expectedTime]])])]),t("div",J,[e[13]||(e[13]=t("label",{for:"customTags"},"自定义标签",-1)),r(t("input",{id:"customTags","onUpdate:modelValue":e[5]||(e[5]=s=>l.value=s),type:"text",placeholder:"输入标签后按回车添加，如：肉鸽，模拟经营，回合制",onKeydown:I(w(T,["prevent"]),["enter"])},null,40,L),[[c,l.value]]),o.value.tags.length>0?(u(),i("div",$,[(u(!0),i(V,null,F(o.value.tags,(s,f)=>(u(),i("span",{key:f,class:"tag"},[k(d(s)+" ",1),t("button",{type:"button",onClick:X=>S(f),class:"tag-remove"},"×",8,z)]))),128))])):b("v-if",!0)]),t("div",G,[t("button",{type:"button",onClick:v,class:"btn-secondary"}," 🔄 重置表单 "),t("button",{type:"submit",class:"btn-primary",disabled:!g.value||n.value},d(n.value?"🌱 正在种植...":"🌱 种下种子"),9,H)])],32),p.value?(u(),i("div",Q,[...e[14]||(e[14]=[t("h4",null,"🎉 项目提交成功！",-1),t("p",null,"你的创意种子已经种下，期待它茁壮成长！",-1)])])):b("v-if",!0)]))}},ee=D(R,[["__scopeId","data-v-350f7c72"]]);export{ee as default};

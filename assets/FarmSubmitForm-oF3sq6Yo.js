import{_ as D,i as m,j as h,c as i,o as u,d as t,e as b,m as r,q as c,t as d,v as y,a as j,s as I,p as w,F as V,g as F,f as k}from"./app-BZdVsTh-.js";import{f as C}from"./request-7grEb9by.js";const E={class:"project-submit-form"},N={class:"form-group"},O={class:"char-count"},U={class:"form-group"},q={class:"char-count"},P={class:"form-group"},A={class:"char-count"},B={class:"form-row"},K={class:"form-group"},M={class:"form-group"},J={class:"form-group"},L=["onKeydown"],$={key:0,class:"tags-container"},z=["onClick"],G={class:"form-actions"},H=["disabled"],Q={key:0,class:"success-message"},R={__name:"FarmSubmitForm",setup(W){const o=m({submitter:"",name:"",description:"",category:"",expectedTime:"",tags:[]}),l=m(""),p=m(!1),n=m(!1),g=h(()=>o.value.submitter.trim()&&o.value.name.trim()&&o.value.description.trim()),T=()=>{const a=l.value.trim();a&&!o.value.tags.includes(a)&&o.value.tags.length<10&&(o.value.tags.push(a),l.value="")},S=a=>{o.value.tags.splice(a,1)},v=()=>{o.value={submitter:"",name:"",description:"",category:"",expectedTime:"",tags:[]},l.value="",p.value=!1},x=async()=>{if(!(!g.value||n.value)){n.value=!0;try{const a={title:o.value.name,description:o.value.description,author:o.value.submitter,category:o.value.category,priority:"ä¸­ç­‰",status:"è®¡åˆ’ä¸­",progress:0,tags:o.value.tags,expected_end_date:o.value.expectedTime?_(o.value.expectedTime):null,github_url:"",demo_url:""},e=await C.createFarmProject(a);if(e.success)window.dispatchEvent(new CustomEvent("projectAdded",{detail:e.data})),p.value=!0,setTimeout(()=>{v()},2e3);else throw new Error(e.error||"åˆ›å»ºé¡¹ç›®å¤±è´¥")}catch(a){console.error("æäº¤é¡¹ç›®å¤±è´¥:",a),alert("æäº¤å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ï¼š"+a.message);const e={id:Date.now().toString(),title:o.value.name,...o.value,status:"è®¡åˆ’ä¸­",create_time:new Date().toISOString(),author:o.value.submitter},s=JSON.parse(localStorage.getItem("farmProjects")||"[]");s.unshift(e),localStorage.setItem("farmProjects",JSON.stringify(s)),window.dispatchEvent(new CustomEvent("projectAdded",{detail:e})),p.value=!0,setTimeout(()=>{v()},2e3)}finally{n.value=!1}}},_=a=>{const e=new Date;switch(a){case"1å‘¨å†…":return new Date(e.getTime()+10080*60*1e3).toISOString().split("T")[0];case"1ä¸ªæœˆå†…":return new Date(e.getTime()+720*60*60*1e3).toISOString().split("T")[0];case"3ä¸ªæœˆå†…":return new Date(e.getTime()+2160*60*60*1e3).toISOString().split("T")[0];case"åŠå¹´å†…":return new Date(e.getTime()+4320*60*60*1e3).toISOString().split("T")[0];case"é•¿æœŸé¡¹ç›®":return new Date(e.getTime()+365*24*60*60*1e3).toISOString().split("T")[0];default:return null}};return(a,e)=>(u(),i("div",E,[e[15]||(e[15]=t("div",{class:"form-header"},[t("h3",null,"ğŸŒ± ç§ä¸‹ä½ çš„åˆ›æ„ç§å­"),t("p",null,"åˆ†äº«ä½ çš„é¡¹ç›®æƒ³æ³•ï¼Œè®©ç¤¾åŒºä¸€èµ·æ¥å¸®åŠ©å®ç°ï¼")],-1)),t("form",{onSubmit:w(x,["prevent"]),class:"submit-form"},[t("div",N,[e[6]||(e[6]=t("label",{for:"submitter"},"å¡«å†™äºº *",-1)),r(t("input",{id:"submitter","onUpdate:modelValue":e[0]||(e[0]=s=>o.value.submitter=s),type:"text",placeholder:"è¯·è¾“å…¥æ‚¨çš„å§“åæˆ–ID",required:"",maxlength:"30"},null,512),[[c,o.value.submitter]]),t("span",O,d(o.value.submitter.length)+"/30",1)]),t("div",U,[e[7]||(e[7]=t("label",{for:"projectName"},"é¡¹ç›®åç§° *",-1)),r(t("input",{id:"projectName","onUpdate:modelValue":e[1]||(e[1]=s=>o.value.name=s),type:"text",placeholder:"ç»™ä½ çš„é¡¹ç›®èµ·ä¸ªå“äº®çš„åå­—",required:"",maxlength:"50"},null,512),[[c,o.value.name]]),t("span",q,d(o.value.name.length)+"/50",1)]),t("div",P,[e[8]||(e[8]=t("label",{for:"projectDescription"},"è¯¦ç»†çµæ„Ÿæè¿° *",-1)),r(t("textarea",{id:"projectDescription","onUpdate:modelValue":e[2]||(e[2]=s=>o.value.description=s),placeholder:"è¯¦ç»†æè¿°ä½ çš„é¡¹ç›®æƒ³æ³•ã€ç›®æ ‡ã€æŠ€æœ¯æ ˆç­‰...",required:"",rows:"6",maxlength:"1000"},null,512),[[c,o.value.description]]),t("span",A,d(o.value.description.length)+"/1000",1)]),t("div",B,[t("div",K,[e[10]||(e[10]=t("label",{for:"projectCategory"},"é¡¹ç›®åˆ†ç±»",-1)),r(t("select",{id:"projectCategory","onUpdate:modelValue":e[3]||(e[3]=s=>o.value.category=s)},[...e[9]||(e[9]=[t("option",{value:""},"é€‰æ‹©åˆ†ç±»",-1),t("option",{value:"2D"},"ğŸ¨ 2D",-1),t("option",{value:"3D"},"ğŸ¯ 3D",-1)])],512),[[y,o.value.category]])]),t("div",M,[e[12]||(e[12]=t("label",{for:"expectedTime"},"é¢„æœŸå®Œæˆæ—¶é—´",-1)),r(t("select",{id:"expectedTime","onUpdate:modelValue":e[4]||(e[4]=s=>o.value.expectedTime=s)},[...e[11]||(e[11]=[j('<option value="" data-v-350f7c72>é€‰æ‹©æ—¶é—´</option><option value="1å‘¨å†…" data-v-350f7c72>âš¡ 1å‘¨å†…</option><option value="1ä¸ªæœˆå†…" data-v-350f7c72>ğŸš€ 1ä¸ªæœˆå†…</option><option value="3ä¸ªæœˆå†…" data-v-350f7c72>ğŸ“… 3ä¸ªæœˆå†…</option><option value="åŠå¹´å†…" data-v-350f7c72>â° åŠå¹´å†…</option><option value="é•¿æœŸé¡¹ç›®" data-v-350f7c72>ğŸ¯ é•¿æœŸé¡¹ç›®</option>',6)])],512),[[y,o.value.expectedTime]])])]),t("div",J,[e[13]||(e[13]=t("label",{for:"customTags"},"è‡ªå®šä¹‰æ ‡ç­¾",-1)),r(t("input",{id:"customTags","onUpdate:modelValue":e[5]||(e[5]=s=>l.value=s),type:"text",placeholder:"è¾“å…¥æ ‡ç­¾åæŒ‰å›è½¦æ·»åŠ ï¼Œå¦‚ï¼šè‚‰é¸½ï¼Œæ¨¡æ‹Ÿç»è¥ï¼Œå›åˆåˆ¶",onKeydown:I(w(T,["prevent"]),["enter"])},null,40,L),[[c,l.value]]),o.value.tags.length>0?(u(),i("div",$,[(u(!0),i(V,null,F(o.value.tags,(s,f)=>(u(),i("span",{key:f,class:"tag"},[k(d(s)+" ",1),t("button",{type:"button",onClick:X=>S(f),class:"tag-remove"},"Ã—",8,z)]))),128))])):b("v-if",!0)]),t("div",G,[t("button",{type:"button",onClick:v,class:"btn-secondary"}," ğŸ”„ é‡ç½®è¡¨å• "),t("button",{type:"submit",class:"btn-primary",disabled:!g.value||n.value},d(n.value?"ğŸŒ± æ­£åœ¨ç§æ¤...":"ğŸŒ± ç§ä¸‹ç§å­"),9,H)])],32),p.value?(u(),i("div",Q,[...e[14]||(e[14]=[t("h4",null,"ğŸ‰ é¡¹ç›®æäº¤æˆåŠŸï¼",-1),t("p",null,"ä½ çš„åˆ›æ„ç§å­å·²ç»ç§ä¸‹ï¼ŒæœŸå¾…å®ƒèŒå£®æˆé•¿ï¼",-1)])])):b("v-if",!0)]))}},ee=D(R,[["__scopeId","data-v-350f7c72"]]);export{ee as default};

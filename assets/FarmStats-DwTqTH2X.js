import{f as c}from"./request-7grEb9by.js";import{_ as r,c as l,o as n,d as a,t as d}from"./app-BGeEgexs.js";const p={name:"FarmStats",data(){return{stats:{total:0,active:0,completed:0},updateInterval:null}},mounted(){this.updateStats(),window.addEventListener("projectAdded",this.updateStats),this.updateInterval=setInterval(this.updateStats,5e3)},beforeUnmount(){this.updateInterval&&clearInterval(this.updateInterval),window.removeEventListener("projectAdded",this.updateStats)},methods:{async updateStats(){try{const s=await c.getFarmListStats();if(s.success){const t=s.data;this.animateUpdate("totalProjects",this.stats.total,t.total||0),this.animateUpdate("activeProjects",this.stats.active,t.active||0),this.animateUpdate("completedProjects",this.stats.completed,t.completed||0),this.stats={total:t.total||0,active:t.active||0,completed:t.completed||0}}}catch(s){console.error("获取项目统计失败:",s),this.updateStatsFromLocalStorage()}},updateStatsFromLocalStorage(){const s=JSON.parse(localStorage.getItem("farmProjects")||"[]"),t=s.filter(o=>o.status==="进行中").length,e=s.filter(o=>o.status==="已完成").length;this.animateUpdate("totalProjects",this.stats.total,s.length),this.animateUpdate("activeProjects",this.stats.active,t),this.animateUpdate("completedProjects",this.stats.completed,e),this.stats={total:s.length,active:t,completed:e}},animateUpdate(s,t,e){t!==e&&this.$refs[s]&&(this.$refs[s].classList.add("updating"),setTimeout(()=>{this.$refs[s]&&this.$refs[s].classList.remove("updating")},300))}}},m={class:"farm-stats"},v={class:"stat-card"},u={class:"stat-info"},h={class:"stat-card"},f={class:"stat-info"},S={class:"stat-card"},j={class:"stat-info"};function _(s,t,e,o,i,g){return n(),l("div",m,[a("div",v,[t[1]||(t[1]=a("div",{class:"stat-icon"},"🌱",-1)),a("div",u,[a("div",{class:"stat-number",ref:"totalProjects"},d(i.stats.total),513),t[0]||(t[0]=a("div",{class:"stat-label"},"总项目数",-1))])]),a("div",h,[t[3]||(t[3]=a("div",{class:"stat-icon"},"🚀",-1)),a("div",f,[a("div",{class:"stat-number",ref:"activeProjects"},d(i.stats.active),513),t[2]||(t[2]=a("div",{class:"stat-label"},"进行中",-1))])]),a("div",S,[t[5]||(t[5]=a("div",{class:"stat-icon"},"✅",-1)),a("div",j,[a("div",{class:"stat-number",ref:"completedProjects"},d(i.stats.completed),513),t[4]||(t[4]=a("div",{class:"stat-label"},"已完成",-1))])])])}const U=r(p,[["render",_],["__scopeId","data-v-e5c2df7d"]]);export{U as default};

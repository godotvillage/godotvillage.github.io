import{g as i}from"./githubAuth-BB48nT_u.js";import{_ as g,c as l,o as a,e as c,d as t,t as u,F as m,f as d,i as h,v as k,l as v}from"./app-CjlwLEwM.js";const U={name:"GitHubLogin",data(){return{currentUser:null,mockUsername:"",isDevelopment:!1}},computed:{isLoggedIn(){return!!this.currentUser}},mounted(){this.loadUserInfo(),window.addEventListener("storage",this.handleStorageChange)},beforeUnmount(){window.removeEventListener("storage",this.handleStorageChange)},methods:{loadUserInfo(){this.currentUser=i.getCurrentUser()},login(){try{i.login()}catch(s){console.error("登录失败:",s),this.$emit("error","登录失败，请重试")}},logout(){try{i.logout(),this.currentUser=null,this.$emit("logout")}catch(s){console.error("登出失败:",s)}},mockLogin(){if(!this.mockUsername.trim()){alert("请输入GitHub用户名");return}try{const s=i.mockLogin(this.mockUsername.trim());this.currentUser=s,this.mockUsername="",this.$emit("login",s)}catch(s){console.error("模拟登录失败:",s),this.$emit("error","模拟登录失败")}},handleStorageChange(s){s.key==="github_user"&&this.loadUserInfo()}}},f={class:"github-login"},_={key:0,class:"user-info"},b=["src","alt"],p={class:"user-details"},L={class:"user-name"},y={class:"user-login"},C={class:"user-actions"},w={class:"login-prompt"},x={key:0,class:"dev-login"},I={class:"mock-login-form"};function G(s,e,H,B,n,o){return a(),l("div",f,[c(" 已登录状态 "),o.isLoggedIn?(a(),l("div",_,[t("img",{src:n.currentUser.avatar_url,alt:n.currentUser.login,class:"user-avatar"},null,8,b),t("div",p,[t("span",L,u(n.currentUser.name||n.currentUser.login),1),t("span",y,"@"+u(n.currentUser.login),1)]),t("div",C,[t("button",{onClick:e[0]||(e[0]=(...r)=>o.logout&&o.logout(...r)),class:"logout-btn",title:"登出"}," 🚪 ")])])):(a(),l(m,{key:1},[c(" 未登录状态 "),t("div",w,[t("button",{onClick:e[1]||(e[1]=(...r)=>o.login&&o.login(...r)),class:"login-btn"},[...e[5]||(e[5]=[t("svg",{class:"github-icon",viewBox:"0 0 16 16",width:"16",height:"16"},[t("path",{fill:"currentColor",d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"})],-1),d(" 使用 GitHub 登录 ",-1)])]),c(" 开发模式下的模拟登录 "),n.isDevelopment?(a(),l("div",x,[e[6]||(e[6]=t("hr",{class:"divider"},null,-1)),e[7]||(e[7]=t("p",{class:"dev-note"},"开发模式 - 模拟登录",-1)),t("div",I,[h(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>n.mockUsername=r),placeholder:"输入GitHub用户名",class:"mock-input",onKeyup:e[3]||(e[3]=v((...r)=>o.mockLogin&&o.mockLogin(...r),["enter"]))},null,544),[[k,n.mockUsername]]),t("button",{onClick:e[4]||(e[4]=(...r)=>o.mockLogin&&o.mockLogin(...r)),class:"mock-login-btn"},"模拟登录")])])):c("v-if",!0)])],2112))])}const V=g(U,[["render",G],["__scopeId","data-v-4a9da809"]]);export{V as default};

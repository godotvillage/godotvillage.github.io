import{b as h}from"./request-7grEb9by.js";import{_ as f,c as n,o as r,e as c,d as e,t as d,F as _,g as m,n as y}from"./app-BFs7gJi_.js";const b={name:"DiscussionDetail",data(){return{discussion:null,loading:!0,error:null}},computed:{discussionNumber(){return this.$route.query.number}},created(){},async mounted(){await this.fetchDiscussion()},methods:{async fetchDiscussion(){this.loading=!0,this.error=null;try{const t=await(await fetch(h+`/discussion/detail/${this.discussionNumber}`)).json();if(t.success)this.discussion=t.data,document.title=`${this.discussion.title} - 论坛`;else throw new Error(t.error)}catch(i){console.error("获取讨论详情失败:",i),this.error=i.message}finally{this.loading=!1}},formatDate(i){const t=new Date(i),l=Math.abs(new Date-t),s=Math.floor(l/(1e3*60*60*24));if(s===1)return"昨天";if(s===0){const a=Math.floor(l/36e5);if(a===0){const o=Math.floor(l/6e4);return o===0?"刚刚":`${o}分钟前`}else return`${a}小时前`}else return s<7?`${s}天前`:t.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})},retry(){this.fetchDiscussion()},openInGitHub(){this.discussion&&this.discussion.url&&window.open(this.discussion.url,"_blank")}},watch:{"$route.params.id":{handler(i){i&&this.fetchDiscussion()},immediate:!1}}},p={class:"discussion-detail"},v={key:0,class:"loading"},g={key:1,class:"error"},k={key:2,class:"discussion-content"},D={class:"back-nav"},w={class:"discussion-header"},M={class:"discussion-title"},C={class:"discussion-meta"},H=["src","alt"],L={class:"meta-info"},N={class:"author"},A={class:"date"},T={key:0,class:"updated"},B={class:"discussion-body"},S=["innerHTML"],x={key:0,class:"discussion-tags"};function z(i,t,u,l,s,a){return r(),n("div",p,[s.loading?(r(),n("div",v,"加载中...")):s.error?(r(),n("div",g,[e("p",null,"加载失败: "+d(s.error),1),e("button",{onClick:t[0]||(t[0]=(...o)=>a.retry&&a.retry(...o)),class:"retry-btn"},"重试")])):s.discussion?(r(),n("div",k,[c(" 返回按钮 "),e("div",D,[e("button",{onClick:t[1]||(t[1]=o=>i.$router.back()),class:"back-btn"},"← 返回论坛")]),c(" 讨论标题和元信息 "),e("header",w,[e("h1",M,d(s.discussion.title),1),e("div",C,[e("img",{src:s.discussion.author.avatarUrl,alt:s.discussion.author.login,class:"avatar"},null,8,H),e("div",L,[e("span",N,"作者: "+d(s.discussion.author.login),1),e("span",A,"发布于: "+d(a.formatDate(s.discussion.createdAt)),1),s.discussion.updatedAt!==s.discussion.createdAt?(r(),n("span",T," 更新于: "+d(a.formatDate(s.discussion.updatedAt)),1)):c("v-if",!0)])])]),c(" 讨论内容 "),e("article",B,[c(' <div class="markdown-body" v-html="renderMarkdown(discussion.body)"></div> '),e("div",{class:"markdown-body",innerHTML:s.discussion.bodyHTML},null,8,S)]),c(" 标签和分类 "),s.discussion.labels.nodes.length>0?(r(),n("div",x,[t[2]||(t[2]=e("span",{class:"tags-label"},"标签:",-1)),(r(!0),n(_,null,m(s.discussion.labels.nodes,o=>(r(),n("span",{key:o.id,class:"tag",style:y({backgroundColor:`#${o.color}`})},d(o.name),5))),128))])):c("v-if",!0)])):c("v-if",!0)])}const I=f(b,[["render",z],["__scopeId","data-v-d6596922"]]);export{I as default};
